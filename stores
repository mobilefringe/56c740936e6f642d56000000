<script src="http://kodekloud.s3.amazonaws.com/sites/5438407c6e6f64462d020000/92b82a88144a6207ab1a5e8e0f63d3d1/craftmap.js"></script>
<div class="content_container main_container">
    <div id="map">
        <img alt="map" src="http://cdn.mallmaverick.com/system/properties/maps/000/000/007/original/VA_Gateway_Map_2000x2000-FINAL.jpg?1367431992" />
    </div>
    <h2 class="stores_main_heading">Shop & Entertainment</h2>
    <p class="store_main_desc">explore • enjoy • shop</p>
    
    <div class="row">
        <div class="col-md-8">
            <div class="store_list" id="store_list_container">
                <script id="store_list_template" type="x-tmpl-mustache/text">
                    <div class="store_list_content" data-cat="{{cat_list}}">
                        <p class="store_initial" style="{{show}}" id="{{initial}}">{{initial}}</p>
                        <p class="store_name"><a href="/stores/{{slug}}">{{name}}</a></p>
                    </div>
                </script>
            </div>
        </div>
        <div class="col-md-4">
            <p class="store_initial">Categories</p>
            <h5 class="category_name active_cat hidden_phone"><a href="#" class="show_all_stores">All</a></h5>
            <div id="category_container" class="hidden_phone">
                <script id="category_template" type="x-tmpl-mustache/text">
                    <h5 class="category_header"><a href="#" class="show_cat_stores" data-id="{{id}}">{{name}}</a></h5>    
                </script>
            </div>
        </div>
    </div>
</div>

<script>
    $(document).ready(function(e){
        init(e);
        function renderAll (){
            var categories = getStoreCategories();
            var stores = getStoresList(); 
            renderStoreList('#store_list_container','#store_list_template', stores, "A", "Z");
            renderGeneral('#category_container', '#category_template', categories);
            show_cat_stores();
        }
        
        $('#map').craftmap({
			image: {
				width: 850,
				height: 850,
			},
			map: {
				position: 'center'
			}
		});
		loadMallDataCached(renderAll); 
    })
</script>