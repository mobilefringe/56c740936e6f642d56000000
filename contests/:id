
<div class="content_container main_container">
    <h4 class="promo_main_header">Contest</h3>
    <div class="row">
        <div class="col-md-8">
            <div id="contest_container">
                <script id="contest_template" type="x-tmpl-mustache/text">
                    <img alt="contest image" class="details_image" src="{{alt_photo_url}}" />
                    <p class="promo_list_name">{{name}}</p>
                    <div class="details_desc">{{{description}}}</div>
                    <form id="contest_form">
                        <input id="property_id" name="contest[property_id]" type="hidden" value="{{property_id}}"/>
                        <input id="contest_id" name="contest[contest_id]" type="hidden"  value="{{id}}" />
                        <input type="hidden" name="cm-name" id="cm-name" />
                        <div class="row">
                            <div class="col-md-6">
                                <label for="first_name">First Name *</label>  
                                <input class="form-control" id="first_name" name="contest[first_name]" type="text" required />
                            </div>
                            <div class="col-md-6">
                                <label for="last_name">Last Name *</label>  
                                <input class="form-control" id="last_name" name="contest[last_name]" type="text" required />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <label for="email">Email *</label> 
                                <input class="form-control" id="email" name="contest[email]" type="email" required />
                            </div>
                            <div class="col-md-6">
                                <label for="phone_number">Phone Number</label>  
                                <input class="form-control" id="phone_number" name="contest[phone]" type="text"  />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <label>
                                    <input type="checkbox" id="agree_terms" /> I agree with <a class="blue" href="#" target="_blank">Terms and Conditions</a>
                                </label>
                                <label>
                                    <input type="checkbox" id="add_to_newsletter" /> Yes, subscribe me to your email list to receive promotions and events!
                                </label>
                                <button type="submit" class="newsletter_btn animated_btn" >Submit</button>
                            </div>
                        </div>
                    </form>
                </script>
            </div>
            
        </div>
        <div class="col-md-4 hidden_phone">
            <img style="margin-bottom:20px;" src="http://assets.codecloudapp.com/sites/56c740936e6f642d56000000/image/png/1456330978000/Plaza2.png" class="" alt="">
            <img style="" src="http://assets.codecloudapp.com/sites/56c740936e6f642d56000000/image/png/1456330970000/Plaza.png" class="" alt="">
        </div> 
    </div>
</div>
<script>
    $(document).ready(function(e){
        init(e);
        loadMallDataCached(renderAll); 
    })
    
    function renderAll(){
        var pathArray = window.location.pathname.split( '/' );
        var slug = pathArray[pathArray.length-1];
        var contestDetails = getContestBySlug(slug);
        if(contestDetails != undefined){
            renderContest('#contest_container','#contest_template', contestDetails);
        }
        else{
            $('#contest_ended').show();
        }
        show_content();
        $('#contest_form').submit(function(e){
            e.preventDefault();
            if ($("#agree_terms").prop("checked") != true){
                alert("Please agree to receive newsletters from " + site_json.mall_name + "." );
                $("#newsletter_agree").focus();
                return false;
            }
            else{
                submit_contest($(this).serialize());
            }
            
        })
    }
</script>